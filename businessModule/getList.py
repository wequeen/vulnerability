#!/usr/bin/env python
#-*- coding:utf-8 -*-
#@Time:2020/7/1414:52
#@Author:mery
#@File:getList.py

from commonModule.get_html import parse_html
import requests
import re




def get_list(url,keyword):
    header = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; Touch; rv:11.0) like Gecko"
    }
    data = {
        "keyword": keyword,
        "condition": "0",
        "keywordFlag": "0",
        "cnvdId":"",
        "cnvdIdFlag": "0",
        "baseinfoBeanbeginTime":"",
        "baseinfoBeanendTime":"",
        "baseinfoBeanFlag": "0",
        "refenceInfo":"",
        "referenceScope": "-1",
        "manufacturerId":"-1" ,
        "categoryId": "-1",
        "editionId": "-1",
        "causeIdStr":"",
        "threadIdStr":"",
        "serverityIdStr":"",
        "positionIdStr":""
    }
    html = requests.post(url, data=data, headers=header)
    result = parse_html(html.text)
    return result

def get_links(url,keyword,links):
    result = get_list(url,keyword)
    link = result.findAll(name="a", attrs={"href": re.compile(".*/flaw/show/*")})
    if len(link) > 10:
        for i in range(0,len(link)-10):
            links.append(link[i].get('href'))
        # print(links)
    else:
        print("不存在含有改关键字的漏洞")
    return links

