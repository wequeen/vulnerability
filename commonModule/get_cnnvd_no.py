#!/usr/bin/env python
#-*- coding:utf-8 -*-
#@Time:2020/6/1622:39
#@Author:mery
#@File:get_cnnvd_no.py

import requests

from commonModule.get_html import parse_html

base_url = 'http://www.cnnvd.org.cn/web/vulnerability/queryLds.tag'

#使用cveno在国家漏洞库中查询该漏洞，获取结果html
def get_cnnvd(cve_no):
    header = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; Touch; rv:11.0) like Gecko"
    }
    data = {
        "CSRFToken":"",
        "cvHazardRating":"",
        "cvVultype":"",
        "qstartdateXq":"",
        "cvUsedStyle":"",
        "cvCnnvdUpdatedateXq":"",
        "cpvendor":"",
        "relLdKey":"",
        "hotLd":"",
        "isArea":"",
        "qcvCname":"",
        "qcvCnnvdid": cve_no,
        "qstartdate":"",
        "qenddate":""
    }
    html = requests.post(base_url,data=data,headers=header)
    result = parse_html(html.text)
    return result

