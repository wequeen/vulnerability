#!/usr/bin/env python
#-*- coding:utf-8 -*-
#@Time:2020/6/1417:04
#@Author:mery
#@File:saveDataToDB.py


from util.initDB import init_DB
from blockChain.saveInfo import save,save_difference
from commonModule.saveInfo import saveServer,saveDB,saveTool,saveProtocol,saveFunction,saveOperation,saveFrame,saveEncryAlgorithm


def main():
    #get_detail()
    sql_createPub = "create table if not EXISTS pubChain (num string,title string,description string,grade string,vulType string,vulNo string,solution string,tag string)"
    init_DB("../bug.db", sql_createPub)
    sql_createUnion = "create table if not EXISTS uniChain (num string,title string,description string,grade string,vulType string,vulNo string,solution string,tag string)"
    init_DB("../bug.db", sql_createUnion)
    sql_createOutside = "create table if not EXISTS outsideChain (num string,title string,description string,grade string,vulType string,vulNo string,solution string,tag string)"
    init_DB("../bug.db", sql_createOutside)
    sql_createOther = "create table if not EXISTS otherChain (num string,title string,description string,grade string,vulType string,vulNo string,solution string,tag string)"
    init_DB("../bug.db", sql_createOther)

    sql_createServer = "create table if not EXISTS serverInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string )"
    init_DB("../bug.db", sql_createServer)
    sql_createDb = "create table if not EXISTS dbInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createDb)
    sql_createTool = "create table if not EXISTS toolsInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createTool)
    sql_createProtocol = "create table if not EXISTS protocolInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createProtocol)
    sql_createFunction = "create table if not EXISTS functionInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createFunction)
    sql_createOperation = "create table if not EXISTS operationInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createOperation)
    sql_createFrame = "create table if not EXISTS frameInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createFrame)
    sql_createEncryptionAlgorithm = "create table if not EXISTS encryAlgoriithmInfo (nameInfo string,cveNo string,description string,grade string,vulType string,cnnvdNo string,annUrl string,notice string,threatType string,title string,tag string)"
    init_DB("../bug.db", sql_createEncryptionAlgorithm)

    #用于存放在公链分类中的漏洞
    save('公链',"pubChain")
    # 用于存放在联盟链分类中的漏洞
    save('联盟链',"uniChain")
    # 用于存放在外围系统分类中的漏洞
    save('外围系统', "outsideChain")

    #用于存储在公链、联盟链、外围系统中无法找到的漏洞记录
    save_difference("","otherChain")

    #用于存储常用服务器相关的漏洞信息
    saveServer()
    #用于存储常用数据库相关的漏洞信息
    saveDB()
    #用于存储常用的工具包相关的漏洞信息
    saveTool()
    #用于存储常用的协议相关的漏洞信息
    saveProtocol()
    #用于存储常用的函数及语言相关的漏洞信息
    saveFunction()
    #用于存储常用的操作系统相关的漏洞信息
    saveOperation()
    #用于存储常用的框架相关的漏洞信息
    saveFrame()
    #用于存储常用的加密算法相关的漏洞信息
    saveEncryAlgorithm()

if __name__ == "__main__":
    main()


